<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link rel="stylesheet" href="css/style.css">
</head>
<body>
	<div id="galleryPage">
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
        <figure><figcaption><i>1<span>233333</span></i></figcaption><a href="#" data-src="https://ss2.bdstatic.com/lfoZeXSm1A5BphGlnYG/skin/453.jpg" data-size="1280x800"></a></figure>
    </div>
</body>
<script>
	function setImg(index) {
	    var oDiv = document.getElementById('galleryPage');
	    var oFigure = oDiv.children[index];
	    var aA = oFigure.children[1];
	    //html5最新属性
	    if (aA.dataset) {
	        var src = aA.dataset.src;
	    } else {
	        var src = aA.getAttribute('data-src');
	    }

	    var oImg = document.createElement('img');
	    oImg.src = src;
	    oImg.width = 150;
	    oImg.height = 150;
	    oImg.style.display = "none";
	    if (aA.children.length == 0) {
	        aA.appendChild(oImg);
	        oImg.style.display = "block";
	    }
	}
	//获得对象距离页面顶端的距离
	function getH(obj) {
	    var h = 0;
	    while (obj) {
	        h += obj.offsetTop;
	        obj = obj.offsetParent;
	    }
	    return h;
	}
	window.onscroll = function () {
	    var oDiv = document.getElementById('galleryPage');
	    var oFigure = oDiv.children;

	    for (var i = 0, l = oFigure.length; i < l; i++) {
	        var aA = oFigure[i].children[1];
	        //检查oLi是否在可视区域
	        var t = document.documentElement.clientHeight + (document.documentElement.scrollTop || document.body.scrollTop);
	        var h = getH(aA);
	        if (h < t) {
	            setTimeout("setImg(" + i + ")", 500);
	        }
	    }
	};
	window.onload = function () {
	    window.onscroll();
	};

</script>
</html>